# EPICS module for the LLRF AMC card low level driver

## Description

EPICS module for the LLRF AMC card low level driver [llrfAmc](https://github.com/slaclab/llrfAmc). It uses AsynPortDriver for its integration into EPICS.

## How the driver works

The modules must be loaded in your IOC in order to configure the LLRF AMC cards. see [README.configureDriver.md](README.configureDriver.md) for details on how to load the module.

When the module is loaded, it will:
- Detect the type of AMC cards used in your application,
- Automatically configure the AMC cards.

The module will also automatically generated asyn parameters which can be used to get information and send commands via PVs. see [README.parameterList.md](README.parameterList.md) for more details.

### AMC card detection

The cards are detected based on the devices defined in the YAML files. The `llrfAmc` driver will look for the DownConverter and UpConverter devices under `/mmio/AppTop/AppCore`:
- First, it will look for the DownConverter device. Currently, only the device called `AmcMrLlrfDownConvert` is supported.
- Then, it will look for a UpConveter device. Currently there are two type of devices supported:
  - The Gen1 UpConverter device called `AmcMrLlrfUpConvert`,
  - The Gen2 UpConverter device called `AmcMrLlrfGen2UpConvert`

If the DownConverter or either of the UpConverter devices is not found, the `llrfAmc` will thrown an `td::runtime_error` exception.

### AMC card configuration

When the module is loaded, it will run the initialization sequence to configure both the DownConverter and UpConverter cards. Therefore, it is important that the default YAML configuration is already loaded when this module is loaded in your application.

## Documentation

You can find several README files which describe different aspects of the module:

File                                                    | Description
--------------------------------------------------------|---------------
[README.configureDriver.md](README.configureDriver.md)  | How to configure the driver in your application.
[README.dependencies.md](README.dependencies.md)        | Which external packages and modules are needed by this module.
[README.parameterList.md](README.parameterList.md)      | List of asyn parameters generated by this module.
